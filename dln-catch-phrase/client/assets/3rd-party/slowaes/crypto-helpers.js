var cryptoHelpers={encode_utf8:function(e){try{return unescape(encodeURIComponent(e))}catch(t){throw"error during utf8 encoding: cryptoHelpers.encode_utf8."}},decode_utf8:function(e){try{return decodeURIComponent(escape(e))}catch(t){throw"error during utf8 decoding: cryptoHelpers.decode_utf8."}},toHex:function(){var e=[];if(arguments.length==1&&arguments[0].constructor==Array)e=arguments[0];else e=arguments;var t="";for(var n=0;n<e.length;n++)t+=(e[n]<16?"0":"")+e[n].toString(16);return t.toLowerCase()},toNumbers:function(e){var t=[];e.replace(/(..)/g,function(e){t.push(parseInt(e,16))});return t},getRandom:function(e,t){if(e===null)e=0;if(t===null)t=1;return Math.floor(Math.random()*(t+1))+e},generateSharedKey:function(e){if(e===null)e=16;var t=[];for(var n=0;n<e*2;n++)t.push(this.getRandom(0,255));return t},generatePrivateKey:function(e,t){var n=jsHash.sha2.arr_sha256(e);return n.slice(0,t)},convertStringToByteArray:function(e){var t=[];for(var n=0;n<e.length;n++){t.push(e.charCodeAt(n))}return t},convertByteArrayToString:function(e){var t="";for(var n=0;n<e.length;n++){t+=String.fromCharCode(e[n])}return t},base64:{chars:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/","="],encode_line:function(e){var t="";for(var n=0;n<e.length;n+=3){t+=this.chars[e[n]>>2];t+=this.chars[(e[n]&3)<<4|e[n+1]>>4];if(!(e[n+1]==null)){t+=this.chars[(e[n+1]&15)<<2|e[n+2]>>6]}else{t+="="}if(!(e[n+2]==null)){t+=this.chars[e[n+2]&63]}else{t+="="}}return t},encode:function(e){var t=this.encode_line(e);var n=t.slice(0,64)+"\n";for(var r=1;r<Math.ceil(t.length/64);r++){n+=t.slice(r*64,r*64+64)+(Math.ceil(t.length/64)==r+1?"":"\n")}return n},decode:function(e){e=e.replace(/[\r\n\t ]+/g,"")+"====";var t=[];var n=[];var r=[];for(var i=0;;i=i+4){n[0]=this.chars.indexOf(e.charAt(i));if(n[0]==64){return t}n[1]=this.chars.indexOf(e.charAt(i+1));n[2]=this.chars.indexOf(e.charAt(i+2));n[3]=this.chars.indexOf(e.charAt(i+3));if(n[0]<0||n[1]<0||n[1]==64||n[2]<0||n[3]<0){throw"error during base64 decoding at pos "+i+": cryptoHelpers.base64.decode."}t.push(n[0]<<2|n[1]>>4);if(n[2]>=0&&n[2]<64){t.push((n[1]&15)<<4|n[2]>>2);if(n[3]>=0&&n[2]<64){t.push((n[2]&3)<<6|n[3])}}}}}}